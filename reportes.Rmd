---
title: "Reporte COVID-19 Redes Sociales"
author: "[Parametría](http://parametria.com.mx/)"
date: "`r format(Sys.time(), '%d %B %Y')`"
mail: "lorenzoln@parametria.com.mx"
twitter: "lolo7no"
github: "LorenzoLeon/covid19_mex_Reportes"
logo: "logo_gallery.png"
output:
  epuRate::epurate:
    toc: TRUE
    number_sections: FALSE
  self_contained: FALSE
params: 
  Fecha de corte: !r Sys.Date()-lubridate::days(1)
  Fecha Mínima: !r as.Date("2020-02-01", format = "%Y-%m-%d")
  numOfBins: 10
knit: (function(inputFile, encoding) { rmarkdown::render(inputFile, encoding = encoding, output_file = file.path(dirname(inputFile), 'index.html'), params = "ask") })
---

LOREMIPSUM


<br>
Descargue este reporte en formato estáfico PDF. [AQUÍ](https://github.com/LorenzoLeon/covid19_mex_Reportes/REPORTE_COVID.pdf)
<br>
Descargue el archivo RMarkdown para crear este reporte aquí
[Rmarkdown](https://github.com/LorenzoLeon/covid19_mex_Reportes/REPORTE_COVID.Rmd)
<br><br>

***

```{r echo=F, background="white", message = FALSE, warning = FALSE}
#theme: cayman
#Sys.setlocale("LC_TIME", "es_ES.UTF-8")
library(knitr, quietly = T)
opts_chunk$set(widgetframe_widgetsdir = 'widgets')
library(leaftime, quietly = T, )
library(xml2, quietly = T)
library(rvest, quietly = T)
#devtools::install_github("gaospecial/wordcloud2")
require(wordcloud2, quietly = T)
## remotes::install_github("wilkelab/ggtext")
library(ggtext, quietly = T)
## devtools::install_github("hadley/emo")
library(emo, quietly = T)
library(hrbrthemes, quietly = T)
library(tidytext, quietly = T)
library(emojifont)
library(widgetframe)
require(foreign, quietly = T)
require(DT, quietly = T)
library(kableExtra, quietly = T)
require(xfun, quietly = T)
require(haven, quietly = T)
library(geojsonio, quietly = T)
require(rgdal, quietly = T)
require(readxl, quietly = T)
require(ggrepel, quietly = T)
require(stringi, quietly = T)
require(xlsx, quietly = T)
require(ggthemes, quietly = T)
require(lubridate, quietly = T)
require(leaflet, quietly = T)
require(plotly, quietly = T)
require(RColorBrewer, quietly = T)
require(hrbthemes, quietly = T)
require(tidyverse, quietly = T)
load.emojifont("OpenSansEmoji.ttf")
load.emojifont("EmojiOne.ttf")
import_roboto_condensed()
#{.tabset .tabset-fade .tabset-pills}
```
# <b>COVID-19 en México</b> {.tabset }
***
Tres partes...

muy divertidas... wuu

## <b>Análisis de datos de la Secretaría de Salud</b>
***

<b>Información Pública - Secretaría de Salud, Redes Sociales y Encuestas de Opinión</b>
<br>
Desde el inicio de la crisis mundial de salud debida al brote del virus COVID-19, el rápido crecimiento del contagio y la desinformación sobre la enfermedad han sido dos de los principales retos a combatir para los gobiernos de los países afectados. En México, la Secretaría de Salud Federal combate en dos frentes. Por un lado, garantizar la suficiencia de recursos e infraestructura médica necesaria para atender al público cuando se alcancen los puntos más críticos de contagio en el país. Y, por otro lado, a través de la Dirección General de Epidemiología, la Secretaría publica diariamente un informe técnico con los casos sospechosos y positivos al COVID-19 en todo el país. 
<p>
Si bien este esfuerzo gubernamental busca combatir la desinformación en el tema, los formatos de presentación de los datos no permiten un análisis sintético del fenómeno. En este marco nace la siguiente propuesta de Parametría. Con el fin de dar garantía al derecho humano de acceso a la información oportuna y completa, que resulta además en este caso de interés público, Parametría pone a disposición del público el siguiente reporte interactivo sobre la evolución del COVID-19 en México.

***
<br><br>
Descargue los datos de este reporte desde en el repositorio de [GITHUB](https://github.com/guzmart/covid19_mex)
<br>
```{r echo=F, background="white", message = FALSE, warning = FALSE}
date <- paste0(unlist(strsplit(as.character(params$`Fecha de corte`), "-")), collapse = "")
filetoread <- paste0("covid_mex_",date,".xlsx")
if(!file.exists(paste0("01_datos/",filetoread))){
download.file(paste0("https://github.com/guzmart/covid19_mex/blob/master/01_datos/", filetoread ,"?raw=true"), destfile = paste0("01_datos/",filetoread))
}
d <- read_excel(paste0("01_datos/",filetoread),
                          col_types = c("numeric", "text", "text", 
                                        "numeric", "date", "text", "text", 
                                        "date", "date", "text", "text", "text", "text" ))%>%
  filter(fecha_corte > params$`Fecha Mínima`)
```
Los datos de `r max(d$fecha_corte)` tienen `r nrow(d)` entradas y `r ncol(d)` columnas.

### <b>Número de casos positivos</b>
***
<br>
La siguiente gráfica presenta la evolución del brote del virus COVID-19 en México. Al igual que otros países en América Latina, y acorde con estudios sobre la velocidad de crecimiento del brote del virus en la región, las curvas de crecimiento del brote en México son una línea recta en escala logarítmica. La gráfica permite seleccionar la temporalidad que el usuario requiera para su visualización.
<br>
Otra forma de observar la tendencia de crecimiento es por medio de la contabilización de los nuevos casos confirmados por día: es decir, cuántas confirmaciones se capturaron en la fecha de publicación. La siguiente gráfica, además, muestra que no existe un crecimiento constante sino que tiende a haber variaciones a lo largo del tiempo.
```{r echo=F, message = FALSE, warning = FALSE}

data_fecha <- d %>% count(fecha_corte) %>% mutate(n_acumulada = cumsum(n)) 
caption <- "Elaboración propia con datos de la Secretaría de Salud | <a href='https://twitter.com/Parametria'>@parametria</a> | <a href='https://twitter.com/lolo7no'>@lolo7no</a> | <a href='https://twitter.com/guzmart_'>@guzmart_</a>"
caption1 <- "Elaboración propia con datos de la Secretaría de Salud | @parametria| @lolo7no | @guzmart_"
titulo <- "Número de casos confirmados de COVID-19 en México"
subtitulo <- paste0("Fecha de corte: ",str_sub(max(data_fecha$fecha_corte), end = -1))
accumulate_by <- function(dat, var) {
  var <- lazyeval::f_eval(var, dat)
  lvls <- plotly:::getLevels(var)
  dats <- lapply(seq_along(lvls), function(x) {
    cbind(dat[var %in% lvls[seq(1, x)], ], frame = lvls[[x]])
  })
  dplyr::bind_rows(dats)
}

fig <- data_fecha%>%
  mutate(Fecha = as.Date(fecha_corte),
         #fff = format(Fecha, format = "%d-%B"),
         `Casos Acumulados` = n_acumulada,
         `Casos Nuevos` = n) %>%
  mutate(
    fff = as.numeric(Fecha)
  )%>%
  select(Fecha, `Casos Acumulados`,`Casos Nuevos`, fff) %>%
  pivot_longer(cols = starts_with("Casos") , values_to= "Casos")%>%
  accumulate_by(~fff)%>%
  mutate(
    `Tipo de Casos` = name
  )

ur2 <- ggplot(fig, 
         aes(x = Fecha,
             frame = frame, 
             opacity = 1,
             y = Casos,
             color = `Tipo de Casos`)) +
  geom_line() +
  scale_x_date(date_breaks = "3 day",
               limits = c(
                 min(as.Date(data_fecha$fecha_corte)-0.7),
                 max(as.Date(data_fecha$fecha_corte)+0.7)
               ),
               expand = c(0,0)) +
  theme_minimal() + 
  labs(title=str_wrap(titulo, width = 50),
       subtitle=subtitulo,
       caption = caption1,
       x="",
       y="Número de casos") +
  theme(plot.title = element_text(size = 20, face = "bold"),
        plot.subtitle = element_text(size = 15),
        plot.caption = element_text(size = 10),
        strip.text = element_text(size = 15),
        legend.text =  element_blank(),
        panel.spacing.x = unit(3, "lines"),
        text = element_text(family = "Arial Narrow"),
        axis.text.x = element_text(size = 12, angle = 90, vjust = 0.5),
        axis.title.y = element_text(size = 15),
        axis.text.y = element_text(size = 15))

ggsave("03_graficas/linea_tiempo.png", plot = ur2 + geom_label(aes(label = Casos))+ guides(label = FALSE), width = 15, height = 10, dpi = 100)

xfun::pkg_load2(c("base64enc", "htmltools", "mime"))
write_excel_csv(fig, "01_datos/Data_fecha_acumulada.csv")
```
<br>
```{r results='asis',echo=FALSE,message=FALSE}
xfun::embed_file('01_datos/Data_fecha_acumulada.csv', text = "Descargue los datos para la siguiente gráfica. AQUÍ")
```

***
<br><br>
```{r fig.width=9, fig.height=6, fig.align='center', echo=F, background="white", message = FALSE, warning = FALSE, fig.cap="Casos Confirmados Acumulados por día"}
ur <- ggplot(fig, 
         aes(x = Fecha,
             frame = frame, 
             opacity = 1,
             y = Casos,
             color = `Tipo de Casos`)) +
  geom_line() +
  scale_x_date(date_breaks = "3 day",
               limits = c(
                 min(as.Date(data_fecha$fecha_corte)-0.7),
                 max(as.Date(data_fecha$fecha_corte)+0.7)
               ),
               expand = c(0,0)) +
  theme_minimal() + 
  labs(title=str_wrap(paste0(titulo,": ", subtitulo), width = 50),
       subtitle=subtitulo,
       x="",
       y="Número de casos") +
  theme(plot.title = element_text(size = 20, face = "bold", hjust = -.5),
        #plot.subtitle = element_text(size = 25),
        #plot.caption = element_text(size = 20),
        strip.text = element_text(size = 15),
        panel.spacing.x = unit(3, "lines"),
        text = element_text(family = "Arial Narrow"),
        axis.text.x = element_text(size = 12, angle = 90, vjust = 0.5),
        axis.title.y = element_text(size = 15),
        axis.text.y = element_text(size = 15))

unt <- enframe(unique(fig$Fecha), name = "id", value = "label")
unt$visible <-  ifelse(unt$id%%3 == 1,T,F)
unt$value <-  as.numeric(as.Date(unt$label))

plotly <- plotly::ggplotly(ur, 
                           tooltip = c("x", "y", "color")
                           )%>%
  plotly::layout(title = list(text = paste0(titulo,
                                    '<br>',
                                    '<sup>',
                                    subtitulo,
                                    '</sup>')),
                 hovermode = "x", 
                 tickvalues ="", 
                 annotations = list(x = 1, y = 0, 
                                    text = caption, 
                                    showarrow = F, 
                                    xref='paper', 
                                    yref='paper', 
                                    xanchor='right', 
                                    yanchor='auto', 
                                    xshift=0, 
                                    yshift=0,
                                    font=list(size=15, color="red")))%>%
  plotly::animation_button(label = "Empezar")%>%
  plotly::animation_slider(visible=F,
                           currentvalue = list(prefix = "YEAR ", 
                                               font = list(color="red")))

htmlwidgets::saveWidget(plotly,selfcontained = F, file="linea_tiempo.html")
plotly

```
<br>
[Link a esta gráfica](https://lorenzoleon.github.io/covid19_mex_Reportes/linea_tiempo.html)
<br>

### <b>Pirámide poblacional</b>
***

<b>Pirámide poblacional de casos positivos a COVID-19 según fecha de reporte oficial</b>
<br>
La siguiente gráfica permite seguir la evolución temporal de la pirámide población de los contagios por COVID-19 en México. Esta información revela información interesante y útil para el lector. Hoy, los datos señalan no sólo que es mayor el contagio de la enfermedad entre los hombres mexicanos, sino que además existen diferencias significativas respecto a las mujeres en ciertos grupos etarios. Asimismo, cabe señalar que las poblaciones etarias más vulnerables parecen mostrar un menor número de casos positivos de COVID-19, manteniéndose así un 64% de los contagios en la población entre los 21 a 50 años. 
<br>
```{r echo=F, message = FALSE, warning = FALSE}
## Agrupamos por edades, sexo y fechas, completamos grupos vacíos y contamos casos. 
data_sexo_edad <- d %>% 
  mutate(
    g_edad = case_when(
      edad<11 ~ "0 a 10 años",
      edad>10&edad<21 ~ "11 a 20 años",
      edad>20&edad<31 ~ "21 a 30 años",
      edad>30&edad<41 ~ "31 a 40 años",
      edad>40&edad<51 ~ "41 a 50 años",
      edad>50&edad<61 ~ "51 a 60 años",
      edad>60&edad<71 ~ "61 a 70 años",
      edad>70&edad<81 ~ "71 a 80 años",
      edad>80~ "80 años o más"
    )
  )%>%
  count(
    fecha_corte, sexo, g_edad
  ) %>% 
  complete(fecha_corte, sexo, g_edad) %>% 
  replace(., is.na(.), 0) %>% 
  group_by(
    sexo, g_edad
  ) %>% 
  mutate(
    n_acumulada = cumsum(n)
  ) %>% 
  complete(fecha_corte, sexo, g_edad) %>% 
  replace(., is.na(.), 0) %>% 
  ungroup()%>% 
  mutate(
    sexo=ifelse(
      str_detect(sexo,"F"), "Mujeres", "Hombres"
    ),
     n_acumulada = ifelse(
       str_detect(sexo, "ombr"), n_acumulada*(-1), n_acumulada
     )
  ) %>% 
  group_by(
    fecha_corte, sexo
  ) %>% 
  mutate(
    prop = round(n_acumulada/sum(abs(n_acumulada))*100)
  ) %>% 
  ungroup() 

## Extraemos promedios de sexo
test <- data_sexo_edad %>% 
  group_by(
    fecha_corte, sexo
  )  %>% 
  summarise(
    n_acumulada = sum(n_acumulada)
  ) %>% 
  mutate(
    prop = round(n_acumulada/sum(abs(n_acumulada))*100),
    g_edad = "Promedio",
  ) %>% 
  ungroup() %>% 
  bind_rows(data_sexo_edad) 

b <- test %>% 
  filter(fecha_corte == max(as.Date(unique(d$fecha_corte))))
write_excel_csv(b,'01_datos/Data_sexo_edad.csv')
```
<br>
```{r results='asis',echo=FALSE,message=FALSE}
xfun::embed_file('01_datos/Data_sexo_edad.csv', text = "Descargue los datos para la siguiente gráfica. AQUÍ")
```
<br>
```{r fig.width=9, fig.height=6, fig.align='center', echo=F, background="white", message = FALSE, warning = FALSE, fig.cap="Distribución de casos por sexo y grupos de edad"}
titulo <- "Piramide poblacional de casos de COVID-19 en México"
ur <- ggplot(b, 
       aes(x = str_wrap(g_edad,15), 
           y = prop, 
           text = paste0(abs(round(prop,1)), "%"),
           fill = sexo)) + 
  geom_bar(stat = "identity", width = .6) +
  scale_y_continuous(
    limits = c(-100,100),
    breaks = seq(-100,100,25),
    labels = paste0(
      c(as.character(seq(100,0,-25)),
        as.character(seq(25,100,25))), "%"
    )
  ) + 
  scale_fill_manual("", values = c("#800026","#FEB24C")) +
  guides(fill = guide_legend(reverse=F)) +
  labs(title=str_wrap(paste0(titulo,": ", subtitulo), width = 55)) +
  theme_minimal() +
  theme(plot.title = element_text(size = 20, face = "bold"),
        text = element_text(family = "Arial Narrow"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        axis.text.x = element_text(size = 15, angle = 90),
        axis.text.y = element_text(size = 20),
        legend.title = element_blank(),
        legend.text = element_text(size = 20),
        legend.position = "bottom") +
  coord_flip() 
plotly <-  plotly::ggplotly(ur, tooltip = c("text"))%>%
  plotly::layout(title = list(text = paste0(titulo,
                                    '<br>',
                                    '<sup>',
                                    subtitulo,
                                    '</sup>')),
                 hovermode = "y", 
                 bargap = 0.1, 
                 barmode = 'overlay', 
                 legend = list(orientation = 'v', x = 0, y = 0.9),
                 annotations = list(x = 1, y = 0, text = caption, 
                                    showarrow = F, xref='paper', yref='paper', 
                                    xanchor='right', yanchor='auto', xshift=0,
                                    yshift=0,font=list(size=15, color="red")))
 
 ggsave("03_graficas/Prop_sexo_edad.png", plot = ur + geom_label(na.rm = T, size = 5, aes(label = ifelse(abs(prop)<1,NA_character_,paste0(abs(round(prop,1)), "%")))), width = 15, height = 10, dpi = 100)
htmlwidgets::saveWidget(plotly, selfcontained = F,file="Prop_sexo_edad.html")
plotly
```
<br>
[Link a esta gráfica](https://lorenzoleon.github.io/covid19_mex_Reportes/Prop_sexo_edad.html)
<br>

### <b>Tabla completa</b> {.tabset .tabset-fade .tabset-pills}
***

<b>Casos de COVID-19 en México por entidad federativa, a la fecha de corte</b>

<br>

#### Tabla por sexo
***

<br>
```{r fig.width=6, fig.height=6, fig.align='center',results='asis',echo=FALSE,message=FALSE}
d_ent <- d %>% 
  count(
    fecha_corte, ent
  ) %>% 
  complete(fecha_corte, ent) %>% 
  replace(., is.na(.), 0) %>% 
  group_by(
    ent
  ) %>% 
  mutate(
    n_acumulada = cumsum(n)
  ) %>% 
  complete(fecha_corte, ent) %>% 
  replace(., is.na(.), 0) %>% 
  ungroup() %>% 
  left_join(
    d %>% 
  mutate(
    g_edad = case_when(
      edad<11 ~ "0 a 10 años",
      edad>10&edad<21 ~ "11 a 20 años",
      edad>20&edad<31 ~ "21 a 30 años",
      edad>30&edad<41 ~ "31 a 40 años",
      edad>40&edad<51 ~ "41 a 50 años",
      edad>50&edad<61 ~ "51 a 60 años",
      edad>60&edad<71 ~ "61 a 70 años",
      edad>70&edad<81 ~ "71 a 80 años",
      edad>80~ "80 años o más"
    )
  )%>%
  count(
    fecha_corte, ent, g_edad
  ) %>% 
  complete(fecha_corte, ent, g_edad) %>% 
  replace(., is.na(.), 0) %>% 
  group_by(
    ent, g_edad
  ) %>% 
  mutate(
    n_acumulada = cumsum(n)
  ) %>% 
  complete(fecha_corte, ent, g_edad) %>% 
  replace(., is.na(.), 0) %>% 
  ungroup() %>% select(-n) %>% 
  pivot_wider(
    names_from = g_edad,
    values_from = n_acumulada
  ) %>% 
  left_join(
    d %>% 
  mutate(
    sexo=ifelse(
      str_detect(sexo,"F"), "Mujeres", "Hombres"
    )
  ) %>% 
  count(
    fecha_corte, ent, sexo
  ) %>% 
  complete(fecha_corte, ent, sexo) %>% 
  replace(., is.na(.), 0) %>% 
  group_by(
    ent, sexo
  ) %>% 
  mutate(
    n_acumulada = cumsum(n)
  ) %>% 
  complete(fecha_corte, ent, sexo) %>% 
  replace(., is.na(.), 0) %>% 
  ungroup() %>% select(-n) %>% 
  pivot_wider(
    names_from = sexo,
    values_from = n_acumulada
  )
  )
  ) %>% 
  rename(
    Fecha = fecha_corte,
    Entidad = ent,
    `Casos nuevos` = n,
    Total = n_acumulada
  ) %>% arrange(desc(Fecha))%>% 
  mutate(Entidad = str_to_title(Entidad),
         Fecha = as.Date.character(Fecha, format = c("%Y-%m-%d")))%>%
  select(Fecha, Entidad, `Casos nuevos`, Total, Hombres, Mujeres, everything())
  

DT::datatable(d_ent%>%select(Fecha, Entidad, `Casos nuevos`, Total, Hombres, Mujeres), width = 400, class= "cell-border stripe", rownames = F, filter = "top",
              extensions = "Buttons", options = list(dom="Bfrtip",
                                                     buttons = c("copy", "excel")))
```

<br>

#### Tabla por edades
***
<br>
```{r fig.width=6, fig.height=6, fig.align='center',results='asis',echo=FALSE,message=FALSE}
DT::datatable(d_ent%>%select(Fecha, Entidad, `Casos nuevos`, Total, ends_with("años"), starts_with("80")), width = 400, class= "cell-border stripe", rownames = F, filter = "top",
              extensions = "Buttons", options = list(dom="Bfrtip",
                                                     buttons = c("copy", "excel")))
```


### <b>Mapa de Casos</b>
***

<b> Mapa de Casos agregados por entidad en el tiempo</b>
<br>
Blah Blah
<br>
```{r echo=F, background="white", message = FALSE, warning = FALSE}
## Leemos la base SHP de polígonos de México
estados_mexico <- readOGR(dsn = "01_datos/México_Estados/",verbose = F)
## Todavía estaba guardada como DF la CDMX
levels(estados_mexico$ESTADO)[9] <- "Ciudad De México"
levels(estados_mexico@data$ESTADO)[9] <- "Ciudad De México"

## Hacemos 10 bins de las fechas hasta ahora.
seq_dates <- seq.Date(from = min(as.Date(d$fecha_corte)), to = max(as.Date(d$fecha_corte)), by = "day")
seq_dates <- enframe(seq_dates, value = "fecha_corte")
seq_dates$bin <- ntile(seq_dates$fecha_corte, 10)
seq_dates <- seq_dates%>%select(-name)

## Tomamos la base de datos, Estructuramos los datos de estado y fecha,
data_fecha <- d %>% 
  mutate(
    ent = tolower(ent),
    ESTADO = stringi::stri_trans_totitle(ent),
    ESTADO = ifelse(ESTADO == "Queretaro", "Querétaro", ESTADO),
    ESTADO = as.factor(ESTADO),
    fecha_corte= as.Date(fecha_corte)
  )%>%
  count(
    fecha_corte, ESTADO
  )%>% ## agregamos estados faltantes (si es el caso)
  right_join(estados_mexico@data)%>%
  ## Completamos fechas faltantes de estados que tuvieron casos después
  complete(fecha_corte, ESTADO)%>%
  ungroup()%>%
  ## Cambiamos los valores faltantes por 0
  mutate(n = ifelse(is.na(n), 0, n))%>%
  ## agregamos los bins de fechas
  left_join(seq_dates) %>%
  drop_na(bin)%>%
  ## Agrupando por bin y por entidad encontramos los casos nuevos y el periodo de fechas de ese bin
  group_by(ESTADO, bin, .drop = F)%>%
  summarise(n = sum(n),
            fechas = paste0 (min(fecha_corte)," a ",max(fecha_corte)),
         fecha_corte = max(fecha_corte))%>%
  group_by(
    ESTADO
  )%>%
  ## Agrupando por estado encontramos los casos acumulados
  mutate(
    n_acumulada = cumsum(n),
    fecha_corte = as.Date(fecha_corte)
  )

## Creamos bins de casos acumulados para asignar valores de color
mybins <- c(0,seq(1,max(data_fecha$n_acumulada, data_fecha$n)+5,10))
my_colors <- brewer.pal(9, "Reds") 
my_colors <- colorRampPalette(my_colors)(length(mybins))
## Creamos una función que transforme número de casos a color
mypalette <- colorBin(palette=my_colors, domain=data_fecha$n_acumulada, na.color="transparent", bins=mybins)

## Transformamos los datos para unir con datos geográficos
data_mapa <- data_fecha %>%
  mutate(n = ifelse(is.na(n), 0, n),
         n_acumulada = ifelse(is.na(n_acumulada), 0, n_acumulada),
         color = mypalette(n_acumulada))%>%
  ## Cambiamos el nombre de cada variable a "Variable"_"Fecha"
  pivot_wider(ESTADO, names_from = fecha_corte, values_from = c("fechas","n","n_acumulada" ,"color"))%>%
  mutate_at(vars(starts_with("n")), ~ifelse(is.na(.), 0, .))%>%
  mutate_at(vars(starts_with("color")), ~ifelse(is.na(.), "#FFF5F0", .))%>%
  select(-ends_with("NA"))%>%
  ## Ordenamos según datos geográficos IMPORTANTE!!
  right_join(estados_mexico@data)
# transformamos la base de datos a matriz para fácil indexación
data_mapa1 <- as.matrix.data.frame(data_mapa)

write_excel_csv(data_mapa,'01_datos/Datos_entidad_Acumulados_para_Mapa.csv')
```
<br>
```{r results='asis',echo=FALSE,message=FALSE}
xfun::embed_file('01_datos/Datos_entidad_Acumulados_para_Mapa.csv', text = "Descargue los datos para la siguiente gráfica. AQUÍ")
```
<br>
```{css, echo = FALSE}
.leaflet-container {
  cursor: pointer !important;
}
```
```{r fig.width=9, fig.height=6, fig.align='center', echo=F, background="white", message = FALSE, warning = FALSE, fig.cap="Mapa de Casos Confirmados de Coronavirus en México"}

## Creamos mapa
mymap <- leaflet(options = leafletOptions(zoomControl = FALSE,
                                          minZoom = 3, 
                                          maxZoom = 7,
                                          dragging = T)) %>% 
  addProviderTiles("Esri.WorldGrayCanvas")  %>%
  setView( lat=21, lng=-103 , zoom=5)%>%addControl(caption, position = "bottomleft")

## Hacemos un loop sobre cada uno de los bins creados 
for (date in (unique(data_fecha$fecha_corte))) {
  ## el nombre del layer por agregar es la fecha de corte
  dateStr <- as.Date(date, origin = "1970-01-01")
  ## Info que sale al pasar el mouse, 
  popup1 <- paste0("<span style='color:#7f0000'><strong>",data_mapa1[,paste0("fechas_",dateStr)],"</strong<></span>",
                   "<br><span style='color: salmon;'><strong>Estado: </strong></span>", 
                   data_mapa$ESTADO, 
                   "<br><span style='color: salmon;'><strong>Casos Totales: </strong></span>", 
                   data_mapa1[,paste0("n_acumulada_",dateStr)],
                   "<br><span style='color: salmon;'><strong>Casos Nuevos: </strong></span>", 
                   data_mapa1[,paste0("n_",dateStr)]
  )
  ## Agregamos layer de polígonos usando el shpfile
  mymap <- mymap %>% addPolygons(data = estados_mexico, 
                                  fillColor = ~data_mapa1[,paste0("color_",dateStr)],
                                  fillOpacity = 0.8,
                                  color = "red",       
                                  weight = 1.5,    
                                  popup = popup1,
                                 ## Nombre del layer
                                  group=dateStr)
}
## Todos los grupos creados
baseDates <- as.Date(unique(data_fecha$fecha_corte))

## Creamos un controlador de los layers
mymap <- mymap %>% addLayersControl(
  baseGroups = baseDates,
  options = layersControlOptions(collapsed = FALSE)) %>% 
  addLegend(position = 'topleft', # agregamos una seleccion de colores de los valores de Casos (10 valores) pero podemos escoger más
            colors = mypalette(seq(1, max(data_fecha$n_acumulada, data_fecha$n),
                                   max(data_fecha$n_acumulada, data_fecha$n)/10)), 
            labels = c("1 Caso",rep("", 8),paste0(max(data_fecha$n_acumulada), " Casos")),
            opacity = 0.7,    
            title = "Casos Totales") %>%
  ## Botón de Estrella para centrar mapa
  addEasyButton(easyButton(position = "bottomright",
    icon = htmltools::span(class = "star", htmltools::HTML("&starf;")),
    onClick = htmlwidgets::JS("function(btn, map){
                    map.setView(new L.latLng(21, -103), 5);
                    }")))

htmlwidgets::saveWidget(mymap, selfcontained = F,file="Mapa_Casos.html")
mymap

```
<br>
[Link a este Mapa](https://lorenzoleon.github.io/covid19_mex_Reportes/Mapa_Casos.html)
<br>
La intensidad del color indica la magnitud de los casos totales georreferenciados por entidad.
<br>

## <b>Análisis de Redes Sociales</b>

***
Es importante hacer un seguimiento de redes Sociales para la comprensión del debate público, principalmente porque, al ser de acceso público, el debate es más cercano a la opinión pública del momento. Este análisis se basa en un scrapping personal de tweets en México que hacen mención de COVID-19. Si bien el sistema no es perfecto (con errores, omisiones e imperfecciones), sirve para tener una buena imagen del debate durante el tiempo.


```{r echo=F, background="white", message = FALSE, warning = FALSE}
caption <- "Elaboración propia con datos de Twitter | <a href='https://twitter.com/Parametria'>@parametria</a> | <a href='https://twitter.com/lolo7no'>@lolo7no</a> | <a href='https://twitter.com/guzmart_'>@guzmart_</a>"
caption1 <- "Elaboración propia con datos de Twitter | @parametria| @lolo7no | @guzmart_"
rm_words <- 
  function(string, words) {
    stopifnot(is.character(string), is.character(words))
    spltted <- strsplit(string, " ", fixed = TRUE) # fixed = TRUE for speedup
    vapply(spltted, function(x) paste(x[!tolower(x) %in% words], collapse = " "), character(1))
  }
# Aplicar str_wrap a objetos dentro de otras funciones (como scale_x_discrete(labels=equis))
strwrap_obj <- function(x) {
  str_wrap(x, width = 10)
}

BigramTokenizer <-
  function(x) {
    unlist(lapply(ngrams(words(x), 2), paste, collapse = " "), use.names = FALSE)
  }
tweets <- readRDS("01_datos/covid_2.rds")
tweets <- tweets %>% 
  as_tibble() %>% 
  distinct(id_str, .keep_all = T)%>%
  mutate(
    hashtags = stri_extract_all(text, regex = "#[[:alnum:]_]+"),
    ats = stri_extract_all(text, regex = "@[[:alnum:]_]+"),
    emojis = stri_extract_all_charclass(text, "\\p{EMOJI}"),
    
    texto = gsub(text, pattern = " ", replacement = "_"),
    texto = gsub(texto, pattern = "[[:space:]]", replacement = ""),
    texto = gsub(texto, pattern = "_", replacement = " "),
    texto = gsub(texto, pattern = "ª", replacement = ""),
    texto = gsub(texto, pattern = "[0-9]+|[[:punct:]]|\\(.*\\)", replacement = ""),
    texto = gsub(texto, pattern = "https[^[:space:]]*", replacement = ""),
    texto = gsub(texto, pattern = "[^[:alpha:][:space:]]*", replacement = ""),
    texto = gsub(texto, pattern = "[[:punct:]]", replacement = ""),
    texto = gsub(texto, pattern = "  ", replacement = " "),
    texto = trimws(texto),
    texto = str_replace_all(texto, pattern = "rt", 
                            replacement = ""),
    fecha = as.POSIXct(created, 
                       format = "%Y-%m-%d %T") - hours(7),
   RT = stri_detect(text, fixed = "RT"),
   replied_TO = ifelse(RT, stri_extract_first(text, regex = "@[[:alnum:]_]+"), "")
  ) %>% filter(fecha>as.POSIXct("2020-03-15", format = "%Y-%m-%d"))

saveRDS(tweets, "01_datos/tweets.rds")
```
Los datos sobre tweets hasta `r max(tweets$fecha)` tienen `r nrow(tweets)` entradas y `r ncol(tweets)` columnas.

### <b>Tiempo</b>
***

Lorem Ipsum
<br>
```{r fig.width=9, fig.height=6, fig.align='center', echo=F, background="white", message = FALSE, warning = FALSE, fig.cap="Línea de Tiempo de Tweets sobre COVID-19 en México - Twitter"}

titulo <- "Frecuencia de tuits que mencionan al "
subtitulo <- paste0("#COVID19mx Tuits agrupados por hora del 15 de marzo al ", as.Date(max(tweets$fecha)))

ur <- ggplot(data = tweets %>%
         group_by(month = month(fecha),day = day(fecha), hour = hour(fecha)) %>%
         summarise(`Número de Tweets` = n(), 
                   retweets = sum(as.numeric(retweet_count), na.rm = T ))%>%
         mutate(Fecha= as.POSIXct(paste0(month," " ,day, " ", hour), format = "%m %d %H")), 
       aes(size = `Número de Tweets`,
           y = `Número de Tweets`,
           color = `Número de Tweets`,
           x = Fecha)) +
  geom_smooth(method = "loess",
              show.legend = F,
              colour="black") +
  geom_point() +
  scale_color_continuous(NULL, NULL, NULL)+
  scale_size(NULL, NULL, NULL)+
  scale_x_datetime(date_breaks = "3 day", date_labels =  "%b/%d %I:00%p")+
  theme_ipsum(grid="Y") +
  labs(title=str_wrap(titulo, width = 80),
       subtitle = str_wrap(subtitulo, width = 80),
       y="Número de tweets",
       x="",
       caption=caption1) +
  theme(plot.title = element_text(size = 35),
        plot.subtitle = element_text(size = 30),
        plot.caption = element_text(size = 20),
        axis.title.x = element_text(size = 20),
        axis.text.y = element_text(size = 20),
        axis.text.x = element_text(angle = 90))

ggsave("03_graficas/linea_tiempo_tweets.png", plot = ur, width = 15, height = 10, dpi = 100)

ur <- ggplot(data = tweets %>%
         group_by(month = month(fecha),day = day(fecha), hour = hour(fecha)) %>%
         summarise(`Número de Tweets` = n(), 
                   retweets = sum(as.numeric(retweet_count), na.rm = T ))%>%
         mutate(Fecha= as.POSIXct(paste0(month," " ,day, " ", hour), format = "%m %d %H")), 
       aes(size = `Número de Tweets`,
           y = `Número de Tweets`,
           color = `Número de Tweets`,
           x = Fecha)) +
  geom_point() +
  scale_color_continuous(NULL, NULL, NULL)+
  scale_size(NULL, NULL, NULL)+
  scale_x_datetime(date_breaks = "3 day", date_labels =  "%b/%d %I:00%p")+
  theme_ipsum(grid="Y") +
  labs(title=str_wrap(titulo, width = 80),
       subtitle = str_wrap(subtitulo, width = 80),
       y="Número de tweets",
       x="",
       caption=caption1) +
  theme(plot.title = element_text(size = 35),
        plot.subtitle = element_text(size = 30),
        plot.caption = element_text(size = 20),
        axis.title.x = element_text(size = 20),
        axis.text.y = element_text(size = 20),
        axis.text.x = element_text(angle = 90))

plotly <- plotly::ggplotly(ur, 
                           tooltip = c("x", "y"),
                           dynamicTicks = TRUE
                           )%>%
  plotly::rangeslider() %>%
  plotly::layout(title = list(text = paste0(titulo,
                                    '<br>',
                                    '<sup>',
                                    subtitulo,
                                    '</sup>'),
                              y = 1.1),
                 hovermode = "x", 
                 tickvalues ="", 
                 annotations = list(x = 1, y = 0, 
                                    text = caption, 
                                    showarrow = F, 
                                    xref='paper', 
                                    yref='paper', 
                                    xanchor='right', 
                                    yanchor='auto', 
                                    xshift=0, 
                                    yshift=0,
                                    font=list(size=15, color="red")))
htmlwidgets::saveWidget(plotly,selfcontained = F, file="linea_tiempo_tweets.html")
plotly
```
<br>
[Link a esta gráfica](https://lorenzoleon.github.io/covid19_mex_Reportes/linea_tiempo_tweets.html)
<br>


### <b>Hashtags, Menciones, Temas</b> {.tabset .tabset-fade}
***
Lorem Ipsum
<br>

#### <b>Temas</b>
***
Lorem Ipsum

<br>
<center>
![Temas más comunes en Tweets sobre COVID-19 en México - Twitter](03_graficas/WC_topicos_twitter.png)
</center>
[Link a esta gráfica](https://lorenzoleon.github.io/covid19_mex_Reportes/WC_topicos_twitter.html)
<br>

#### <b>Hashtags</b>
***
Blah Blah
<br>
<center>
![Hashtags más comunes en Tweets sobre COVID-19 en México - Twitter](03_graficas/WC_hashtags_twitter.png)
</center>
[Link a esta gráfica](https://lorenzoleon.github.io/covid19_mex_Reportes/WC_hashtags_twitter.html)
<br>

#### <b>Menciones</b>
***
BLahBLAH
<br>
<center>
![Menciones más comunes en Tweets sobre COVID-19 en México - Twitter](03_graficas/WC_ats_twitter.png)
</center>
[Link a esta gráfica](https://lorenzoleon.github.io/covid19_mex_Reportes/WC_menciones_twitter.html)
<br>

### <b>Emojis!</b> `r emo::ji("smile")`
***
Lorem Ipsum
<br>
```{r fig.width=9, fig.height=6, fig.align='center', echo=F, background="white", message = FALSE, warning = FALSE, fig.cap="Emojis más comunes en Tweets sobre COVID-19 en México - Twitter"}
`%notin%` <- Negate(`%in%`)

  if(!file.exists("01_datos/emojis.rds")){
    emojis <- tweets %>% select(id_str, emojis)%>%unnest(cols = emojis)%>%
    drop_na() %>%group_by(emojis) %>% summarise(n = n()) %>% arrange(desc(n))%>%
    filter(is.na(as.numeric(emojis)),!str_detect(emojis, "#"),emojis %notin% c("*","!!","‼"))
  
  emoji_to_link <- function(x) {
    paste0("https://emojipedia.org/emoji/",x) %>%
      read_html() %>%
      html_nodes("tr td a") %>%
      .[1] %>%
      html_attr("href") %>%
      paste0("https://emojipedia.org/", .) %>%
      read_html() %>%
      html_node('div[class="vendor-image"] img') %>%
      html_attr("src")
  }
  link_to_img <- function(x, size = 25) {
    paste0("<img src='", x, "' width='", size, "'/>")
  }
  thead_emojis <- head(emojis, 20)%>%
    mutate(ems1 = stri_extract_all(emojis, regex = "\\p{Emoji_Presentation}"),
           ems1 = map(ems1, unique), 
           len = as.double(map(ems1, length)),
           len = ifelse(is.na(ems1), NA_real_, len),
           ems2 = stri_extract_all(emojis, regex = "\\p{Emoji_Modifier}"),
           ems3 = stri_extract_all(emojis, regex = "\\p{Emoji_Modifier_Base}"),
           ems4 = stri_extract_all(emojis, regex = "\\p{Emoji_Component}"),
           ems4 = ifelse(is.na(ems1), emojis, NA_character_),
           count= stri_count(emojis, regex = "\\p{Emoji}"),
           count1=stri_count(emojis, regex = "\\p{Emoji_Presentation}"),
           count2=stri_count(emojis, regex = "\\p{Emoji_Modifier}"),
           count3=stri_count(emojis, regex = "\\p{Emoji_Modifier_Base}"),
           count4=stri_count(emojis, regex = "\\p{Emoji_Component}"),
           countif = case_when(
             count==1 | len==1| count1 == 1| count2 == 1| count3 == 1| count4 == 1 ~ as.integer(1),
             !is.na(ems4) ~ stri_count(emojis, regex="\\p{Emoji}"),
             T ~ as.integer(count)
           ),
           finalems = ifelse(count==1, emojis, NA),
           finalems = ifelse(ifelse(is.na(len), F, len == 1), ems1, finalems),
           finalems = ifelse(countif>1, emojis, finalems),
           finalems = ifelse(is.na(finalems), ifelse(countif==1, ems3, finalems), finalems),
           )%>%
    transmute(family = ifelse(is.na(ems4), "OpenSansEmoji" , "EmojiOne"),
              emojis = finalems,
              n = n)
  
  thead_emojis <- thead_emojis %>%
    mutate(url = map_chr(emojis, slowly(~plyr::try_default(emoji_to_link(.x), NA, quiet = T), rate_delay(1))),
           label = link_to_img(url))
  
  thead_emojis <- thead_emojis%>%
    mutate(emojis = ifelse(is.na(url),stri_extract_all(emojis, regex = "\\p{Emoji_Presentation}"), emojis))%>%
    unnest(emojis)%>%
    mutate(url = ifelse(is.na(url),map_chr(emojis, slowly(~plyr::try_default(emoji_to_link(.x), NA), rate_delay(1))), url),
           label = link_to_img(url),
           `Número de Tweets`=n)
  saveRDS(thead_emojis, "01_datos/emojis.rds")
  } else {
  thead_emojis <- readRDS("01_datos/emojis.rds")
}

titulo <- "Emojis más usados en tweets con menciones de COVID-19 en Twitter"
ur <-  ggplot(thead_emojis%>%distinct(emojis, .keep_all = T), aes(x=emojis, y=`Número de Tweets`, fill = emojis,  label = label, family = family)) + 
  geom_bar(stat = "identity") +
  geom_richtext(label.color = NA, label.padding = grid::unit(rep(0, 4), "pt"),  size = 5, vjust = 1) +
  scale_fill_discrete(NULL, NULL, NULL)+
  labs(title=str_wrap(titulo, width = 70),
       y="Número de tweets",
       x="",
       caption=caption1) +
  theme_minimal()+
  #scale_x_discrete(labels = emojis) +
  theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank())
ggsave(filename = "03_graficas/04_emojis_twitter.png",plot = ur,
       width = 15, height = 10, dpi = 100)

subtitulo <- paste0("#COVID19mx Tuits del 15 de marzo al ", as.Date(max(tweets$fecha)))
data_emojis <- thead_emojis%>%distinct(emojis, .keep_all = T)
ur <- ggplot(data_emojis, 
             aes(x=emojis,
                 y=`Número de Tweets`, fill = emojis,  label = emojis, family = family)) + 
  geom_bar(stat = "identity") +
  geom_text(size = 5, vjust = 1) +
  guides(fill = F)+
  scale_fill_discrete(NULL, NULL, NULL)+
  labs(title=str_wrap(titulo, width = 70),
       y="Número de tweets",
       x="") +
  theme_minimal()+
  #scale_x_discrete(labels = emojis) +
  theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank())

plotly <- plotly::ggplotly(ur, 
                           tooltip = c("label", "y")
                           )%>%
  plotly::layout(title = list(text = paste0(titulo,
                                    '<br>',
                                    '<sup>',
                                    subtitulo,
                                    '</sup>'),
                              y = 1.1),
                 tickvalues ="", 
                 annotations = list(x = 1, y = 0, 
                                    text = caption, 
                                    showarrow = F, 
                                    xref='paper', 
                                    yref='paper', 
                                    xanchor='right', 
                                    yanchor='auto', 
                                    xshift=0, 
                                    yshift=0,
                                    font=list(size=15, color="red")))
htmlwidgets::saveWidget(plotly,selfcontained = F, file="Emojis_twitter.html")
plotly
```
[Link a esta gráfica](https://lorenzoleon.github.io/covid19_mex_Reportes/Emojis_twitter.html)
<br>


### <b>Análisis de Sentimiento</b>
***

LOREM IPSUM
<br>
```{r fig.width=9, fig.height=8, fig.align='center', echo=F, background="white", message = FALSE, warning = FALSE, fig.cap="Análisis de Sentimiento en Tweets sobre COVID-19 en México - Twitter"}

afinn <- readRDS("DiccionarioUNAfin.rds")%>%
  filter(!is.na(mean)) %>% rename(Puntuacion = mean)
desc <- afinn %>% distinct(root, .keep_all = T) %>% 
  select(-Palabra)%>%arrange(desc(Puntuacion)) 
asce <- afinn %>% distinct(root, .keep_all = T)%>% 
  select(-Palabra)%>%arrange(Puntuacion)
general_afinn <- tweets%>%select(id_str, texto, fecha)%>%
  mutate(id = 1:length(texto),
         id = formatC(id, width = 3, format="d", flag="0")) %>% 
  unnest_tokens(input = "texto", output = "Palabra") %>%
  inner_join(afinn,., by = "Palabra") %>%
  #mutate(Tipo = ifelse(Puntuacion > 0, "Positiva", "Negativa"))  %>%
  group_by(month = month(fecha), day = day(fecha), hour = hour(fecha), id) %>% 
  summarise(puntuacion = sum(Puntuacion)) %>%
  group_by(month, day, hour) %>% 
  summarise(puntuacion = mean(puntuacion),
            n = n()) %>%
  mutate(puntuacion = ifelse(is.na(puntuacion), 0, puntuacion),
         colour = ifelse(puntuacion>0,"positivo",
                         ifelse(puntuacion<0,"negativo","neutral")),
         alpha = abs(puntuacion))%>%
  ungroup()%>%
  mutate(Fecha = as.POSIXct(paste0(month, " " ,day, " ", hour), format = "%m %d %H"),
         `Número de tweets` = n)


titulo <- "Análisis de sentimiento en tweets de COVID19"
subtitulo <- "Cada círculo representa un día; el tamaño del círculo indica la cantidad de tweets encontrados por día. <br />Una puntuación mayor a cero representa un sentimiento promedio positivo; una menor, un negativo."

ur <- ggplot(general_afinn ,
       aes(x = Fecha,
           y = puntuacion,
           col = colour,
           size=`Número de tweets`)) +
  geom_point()+
  scale_x_datetime(date_breaks = "2 day", date_labels =  "%b/%d %I%p")+
  scale_color_manual(values = c("#FC4E07", "grey",  "#00AFBB")) +
  scale_size_continuous("Sentimiento",
                        guide = guide_legend(override.aes = list(colour = "#E7B800"))) +
  guides(color = F) +
  xlab("") + ylab("Puntuación")  +
  labs(title = str_wrap(titulo, width = 90),
       subtitle= str_wrap(subtitulo, width = 90),
       caption=caption1,
       x="Mes",
       y="Tweets") +
  theme_ipsum() +
  scale_fill_distiller("",palette="Spectral") +
  theme(plot.title = element_text(size = 25),
        plot.subtitle = element_text(size = 20),
        plot.caption = element_text(size = 15),
        legend.key.size = unit(1, "cm"),
        legend.title = element_text(size = 10),
        legend.text = element_text(size = 10),
        axis.title.x = element_text(size = 15),
        axis.text.y = element_text(size = 15),
        axis.text.x = element_text(angle = 35))
ggsave(filename = "03_graficas/COVIDTweetsSentimiento.png",plot = ur + geom_smooth(method="loess", show.legend = F, colour="black") + geom_point(),
       width = 15, height = 10, dpi = 100)

plotly <- plotly::ggplotly(ur, 
                           tooltip = c("x", "y", "size"),
                           dynamicTicks = TRUE
                           )%>%
  plotly::rangeslider() %>%
  plotly::layout(title = list(text = paste0(titulo,
                                    '<br>',
                                    '<sup><sup>',
                                    subtitulo,
                                    '</sup></sup>'),
                              y = 1.3, size = 3),
                 hovermode = "x", 
                 tickvalues ="", 
                 legend = list(orientation = 'v', x=1, y=.5),
                 annotations = list(x = 1, y = 0, 
                                    text = caption, 
                                    showarrow = F, 
                                    xref='paper', 
                                    yref='paper', 
                                    xanchor='right', 
                                    yanchor='auto', 
                                    xshift=0, 
                                    yshift=0,
                                    font=list(size=15, color="red")))
htmlwidgets::saveWidget(plotly,selfcontained = F, file="linea_tiempo_sentimiento_tweets.html")
plotly

```

[Link a esta gráfica](https://lorenzoleon.github.io/covid19_mex_Reportes/linea_tiempo_sentimiento_tweets.html)
<br>



## <b>Análisis de Opinión Pública</b>
***
<br>
Aunque son diversos los aprendizajes que se pueden obtener de la crisis derivada por la pandemia del COVID-19, queremos destacar dos principalmente. Primero, rescatar que el personal médico, los cuerpos de seguridad y protección civil, así como los campesinos y comerciantes de productos básicos son grupos de primaria atención ya que de su trabajo depende el buen funcionamiento de la estructura social. Segundo, la importancia de la empatía como motor de la respuesta más efectiva ante una catástrofe: la acción colectiva. Los ciudadanos de la aldea global juegan hoy un papel crucial ante esta pandemia, en esta medida, el seguimiento a sus opiniones y comportamientos son esenciales tanto para alterar el curso de la crisis como para entender su desarrollo. 

<br>
Con el fin de concentrar y uniformar la información sobre la opinión pública respecto a la pandemia del COVID-19 en el mundo, Parametría presenta este ejercicio acumulativo de mediciones nacionales e internacionales en el tema. La diversidad de información presentada en este tipo de trackings de opinión pública permite no solo conocer los esfuerzos del gremio por obtener datos en otros países, sino además facilita la comparabilidad de resultados. En general, los datos evidencian no solo el alto nivel de conocimiento de la sociedad respecto al tema, sino también su gran preocupación frente al virus como una amenaza latente tanto para la salud personal como para la economía familiar. De hecho, las diversas mediciones coinciden en la percepción pesimista de los entrevistados respecto al futuro desarrollo de la pandemia. Asimismo, la información revela posiciones contrastantes en la evaluación del trabajo de los gobiernos ante la crisis, así como respecto a las acciones gubernamentales a nivel local. 

<br>

```{r echo=F, background="white", message = FALSE, warning = FALSE}
rm_accent <- function(str,pattern="all") {
   if(!is.character(str))
    str <- as.character(str)

  pattern <- unique(pattern)

  if(any(pattern=="Ç"))
    pattern[pattern=="Ç"] <- "ç"

  symbols <- c(
    acute = "áéíóúÁÉÍÓÚýÝ",
    grave = "àèìòùÀÈÌÒÙ",
    circunflex = "âêîôûÂÊÎÔÛ",
    tilde = "ãõÃÕñÑ",
    umlaut = "äëïöüÄËÏÖÜÿ",
    cedil = "çÇ"
  )

  nudeSymbols <- c(
    acute = "aeiouAEIOUyY",
    grave = "aeiouAEIOU",
    circunflex = "aeiouAEIOU",
    tilde = "aoAOnN",
    umlaut = "aeiouAEIOUy",
    cedil = "cC"
  )

  accentTypes <- c("´","`","^","~","¨","ç")

  if(any(c("all","al","a","todos","t","to","tod","todo")%in%pattern)) # opcao retirar todos
    return(chartr(paste(symbols, collapse=""), paste(nudeSymbols, collapse=""), str))

  for(i in which(accentTypes%in%pattern))
    str <- chartr(symbols[i],nudeSymbols[i], str) 

  return(str)
}

cuadros_OP <- read_excel(paste0("01_datos/", "Cuadros_HTML2.xlsx"))

# Transformaciones ----
names(cuadros_OP)[5:24] <- paste0("r_", names(cuadros_OP)[5:24])
cuadros_OP <- cuadros_OP %>% 
  pivot_longer(cols = starts_with("r_"), 
               names_prefix = "r_",
               names_to = "id",
               values_to = "value")%>%
  drop_na(value)%>%
  mutate(
    País = ifelse(
      País=="USA", "EEUU", País
    ),
    value = value/100,
    id = ifelse(id=="Nivel", País, id), 
    text = paste0(id, "\n", "Valor: " ,round(value*100, 0), "%" , "\n", str_wrap(Pregunta, 25), "\nEncuestadora: ", Encuesta )
  )
categorias <- unique(cuadros_OP$Categoría)

```
<br>

### <b>Nivel de información respecto al COVID-19</b>
***
<br>
Resultados de distintas encuestadoras a nivel mundial
<br>
```{r fig.width=9, fig.height=6, fig.align='center', echo=F, background="white", message = FALSE, warning = FALSE, fig.cap="Información sobre COVID-19"}
caption <- "Elaboración propia con datos de <a href='https://wapor.org/'>WAPOR</a> | <a href='https://twitter.com/Parametria'>@parametria</a> | <a href='https://twitter.com/lolo7no'>@lolo7no</a> | <a href='https://twitter.com/guzmart_'>@guzmart_</a>"

niv_con <- cuadros_OP %>% 
  filter(Categoría=="Noticias") %>% 
  filter(str_detect(id,"1")) %>% 
  arrange(País) %>% 
  mutate(
    order = case_when(
      str_starts(País, "Bra")~ 1,
      str_starts(País, "Can")~ 2,
      str_starts(País, "M")~ 3,
      str_starts(País, "Por")~ 4,
      str_starts(País, "Qat")~ 5,
      str_starts(País, "E")~ 6,
      T ~ NA_real_
    ),
    prop = round(value*100),
    Porcentaje = paste0(round(value*100), "%")
  )

p <- 
  ggplot(niv_con,
       aes(x = reorder(paste0(str_wrap(Encuesta, 20), "\n",País), order), y = prop,
           fill = País, label = Porcentaje)) +
  geom_col(width = 0.5) + 
  theme_minimal() + 
  scale_fill_manual("",
                    values = c(
                      brewer.pal(n=9, "Blues")[2],
                      brewer.pal(n=9, "Blues")[4],
                      brewer.pal(n=9, "Blues")[6],
                      brewer.pal(n=9, "Blues")[7],
                      brewer.pal(n=9, "Blues")[8],
                      brewer.pal(n=9, "Blues")[9]
                    )) +
  ylim(0, 105) +
  labs(x="",
       y="%") +
  theme(plot.title = element_text(size = 20, face = "bold"),
        plot.subtitle = element_text(size = 15),
        plot.caption = element_text(size = 10),
        panel.spacing.x = unit(3, "lines"),
        text = element_text(family = "Arial Narrow"),
        axis.text.x = element_text(size = 10, vjust = 0.5),
        axis.text.y = element_text(size = 15),
        legend.position = "none")
  
plotly <- ggplotly(p, dynamicTicks = TRUE, tooltip = c("label","fill"))%>%
  plotly::layout(hovermode = "x", 
                 tickvalues ="", 
                 annotations = list(x = 1, y = 0, 
                                    text = caption, 
                                    showarrow = F, 
                                    xref='paper', 
                                    yref='paper', 
                                    xanchor='right', 
                                    yanchor='auto', 
                                    xshift=0, 
                                    yshift=0,
                                    font=list(size=15, color="red")))
htmlwidgets::saveWidget(plotly,selfcontained = F, file="informacion_op.html")
plotly
```
<br>

### <b>Evaluación del tratamiento mediático de la información sobre el COVID-19</b>
***
<br>
Resultados de distintas encuestadoras a nivel mundial
<br>
```{r fig.width=9, fig.height=6, fig.align='center', echo=F, background="white", message = FALSE, warning = FALSE, fig.cap="Tratamiento mediático sobre COVID-19"}

manejo_media <- cuadros_OP %>% 
  filter(Categoría=="Manejo Medios") %>% 
  filter(!str_detect(id,"99")) %>% 
  arrange(País) %>% 
  mutate(
    prop = round(value*100),
    Porcentaje = paste0(round(value*100), "%")
  )

p <- 
  ggplot(manejo_media,
       aes(x = str_wrap(id, 15), y = prop,
           fill = id, label = Porcentaje)) +
  geom_col(width = 0.5) +
  facet_wrap(~ Encuesta) +
  theme_minimal() + 
  scale_fill_manual("",
                    values = c(
                      brewer.pal(n=9, "Blues")[2],
                      brewer.pal(n=9, "Blues")[4],
                      brewer.pal(n=9, "Blues")[6],
                      brewer.pal(n=9, "Blues")[8],
                      brewer.pal(n=9, "Blues")[9]
                    )) +
  labs(x="",
       y="%") +
  theme(strip.text = element_text(size = 20),
        text = element_text(family = "Arial Narrow"),
        axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        legend.position = "none")

  
plotly <- ggplotly(p, tooltip = "label") %>%
  plotly::layout(
                 hovermode = "x", 
                 tickvalues ="", 
                 annotations = list(x = 1, y = 0, 
                                    text = caption, 
                                    showarrow = F, 
                                    xref='paper', 
                                    yref='paper', 
                                    xanchor='right', 
                                    yanchor='auto', 
                                    xshift=0, 
                                    yshift=0,
                                    font=list(size=15, color="red")))
htmlwidgets::saveWidget(plotly,selfcontained = F, file="evaluacion_medios_op.html")
plotly
```
<br>

### <b>Aprobación del trabajo del Presidente en el manejo de la crisis derivada de la pandemia del COVID-19 (México)</b>
***
<br>
Resultados de distintas encuestadoras en México
<br>

```{r fig.width=9, fig.height=6, fig.align='center', echo=F, background="white", message = FALSE, warning = FALSE, fig.cap="Aprobación Presidente durante crisis de COVID-19"}
titulo <- "Aprobación del trabajo del Presidente en el manejo de la crisis derivada de la pandemia del COVID-19 (México)"

apr_pres <- cuadros_OP %>% 
  filter(Categoría=="Aprobar") %>% 
  filter(str_detect(Encuesta,"Param|Ref|Mitof|Demo")) %>% 
  filter(!str_detect(Pregunta,"gobernador")) %>% filter(!str_detect(id,"99")) %>% 
  arrange(Encuesta) %>% 
  mutate(
    prop = round(value*100),
    Porcentaje = paste0(round(value*100), "%")
  )

p <- 
  ggplot(apr_pres,
       aes(x = str_wrap(id, 15), y = prop,
           fill = id, label = Porcentaje)) +
  geom_col(width = 0.5) +
  facet_wrap(~ Encuesta, nrow = 2) +
  theme_minimal() + 
  scale_fill_manual("",
                    values = c(
                      brewer.pal(n=9, "Blues")[4],
                      brewer.pal(n=9, "Blues")[8]
                    )) +
  labs(x="",
       y="%") +
  theme(strip.text = element_text(size = 20),
        panel.spacing.x = unit(3, "lines"),
        text = element_text(family = "Arial Narrow"),
        axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        legend.position = "none")
  
plotly <- ggplotly(p, tooltip = "label") %>%
  plotly::layout(hovermode = "x", 
                 tickvalues ="", 
                 annotations = list(x = 1, y = 0, 
                                    text = caption, 
                                    showarrow = F, 
                                    xref='paper', 
                                    yref='paper', 
                                    xanchor='right', 
                                    yanchor='auto', 
                                    xshift=0, 
                                    yshift=0,
                                    font=list(size=15, color="red")))
htmlwidgets::saveWidget(plotly,selfcontained = F, file="aprobacion_pres_op.html")
plotly

```
<br>

### <b>Aprobación del trabajo del Presidente en el manejo de la crisis derivada de la pandemia del COVID-19 (Internacional)</b>
***
<br>
Resultados de distintas encuestadoras a nivel mundial.
Sólo se muestran las proporciones de evaluaciones positivas.
<br>
```{r fig.width=9, fig.height=6, fig.align='center', echo=F, background="white", message = FALSE, warning = FALSE, fig.cap="Aprobación Presidentes Internacional durante crisis de COVID-19"}

apr_pres_int <- cuadros_OP %>% 
  filter(Categoría=="Aprobar") %>% 
  filter(!str_detect(Encuesta,"Param|Ref|Mitof|Demo")) %>% 
  filter(str_detect(id,"1")) %>% filter(!str_detect(Pregunta, "obierno del estado")) %>% 
  arrange(Encuesta) %>% 
  mutate(
    order = case_when(
      str_starts(País, "Al")~ 1,
      str_starts(País, "Bra")~ 2,
      str_starts(País, "Hon")~ 3,
      str_starts(País, "Nic")~ 4,
      str_starts(País, "Pan")~ 5,
      str_starts(País, "E")~ 6,
      T ~ NA_real_
    ),
    prop = round(value*100),
    Porcentaje = paste0(round(value*100), "%")
  )

p <- 
  ggplot(apr_pres_int,
       aes(x = reorder(paste0(str_wrap(Encuesta, 20), "\n",País), order), y = prop,
           fill = País, label = Porcentaje)) +
  geom_col(width = 0.5) +
  theme_minimal() + 
  scale_fill_manual("",
                    values = c(
                      "gray",
                      brewer.pal(n=9, "Blues")[3],
                      brewer.pal(n=9, "Blues")[5],
                      brewer.pal(n=9, "Blues")[7],
                      brewer.pal(n=9, "Blues")[9]
                    )) +
  labs(x="",
       y="%") +
  theme(strip.text = element_text(size = 20),
        panel.spacing.x = unit(3, "lines"),
        text = element_text(family = "Arial Narrow"),
        axis.text.x = element_text(size = 15),
        axis.text.y = element_text(size = 15),
        legend.position = "none")
  
plotly <- ggplotly(p, tooltip = c("fill", "label")) %>%
  plotly::layout(
                 hovermode = "x", 
                 tickvalues ="", 
                 annotations = list(x = 1, y = 0, 
                                    text = caption, 
                                    showarrow = F, 
                                    xref='paper', 
                                    yref='paper', 
                                    xanchor='right', 
                                    yanchor='auto', 
                                    xshift=0, 
                                    yshift=0,
                                    font=list(size=15, color="red")))
htmlwidgets::saveWidget(plotly,selfcontained = F, file="aprobacion_pres_int_op.html")
plotly
```
<br>

### <b>Aprobación del trabajo gubernamental local en el manejo de la crisis derivada de la pandemia del COVID-19</b>
***
<br>
Resultados de distintas encuestadoras a nivel mundial.
Sólo se muestran las proporciones de evaluaciones positivas.
<br>
```{r fig.width=9, fig.height=6, fig.align='center', echo=F, background="white", message = FALSE, warning = FALSE, fig.cap="Aprobación Gobierno durante crisis de COVID-19"}

apr_gob_loc <- cuadros_OP %>% 
  filter(Categoría=="Aprobar") %>% 
  filter(str_detect(id,"1")) %>% filter(str_detect(Pregunta, "estado")) %>% 
  arrange(Encuesta) %>% 
  mutate(
    order = case_when(
      str_starts(País, "Bra")~ 1,
      str_starts(País, "M")~ 2,
      str_starts(País, "E")~ 3,
      T ~ NA_real_
    ),
    prop = round(value*100),
    Porcentaje = paste0(round(value*100), "%")
  )

p <- 
  ggplot(apr_gob_loc,
       aes(x = reorder(paste0(str_wrap(Encuesta, 20), "\n",País), order), y = prop,
           fill = País, label = Porcentaje)) +
  geom_col(width = 0.5) +
  theme_minimal() + 
  scale_fill_manual("",
                    values = c(
                      brewer.pal(n=9, "Blues")[2],
                      brewer.pal(n=9, "Blues")[6],
                      brewer.pal(n=9, "Blues")[9]
                    )) +
  labs(x="",
       y="%") +
  theme(strip.text = element_text(size = 20),
        panel.spacing.x = unit(3, "lines"),
        text = element_text(family = "Arial Narrow"),
        axis.text.x = element_text(size = 15),
        axis.text.y = element_text(size = 15),
        legend.position = "none")
  
plotly <- ggplotly(p, tooltip = c("fill", "label")) %>%
  plotly::layout(
                 hovermode = "x", 
                 tickvalues ="", 
                 annotations = list(x = 1, y = 0, 
                                    text = caption, 
                                    showarrow = F, 
                                    xref='paper', 
                                    yref='paper', 
                                    xanchor='right', 
                                    yanchor='auto', 
                                    xshift=0, 
                                    yshift=0,
                                    font=list(size=15, color="red")))
htmlwidgets::saveWidget(plotly,selfcontained = F, file="aprobacion_gob_int_op.html")
plotly
```
<br>

### <b>Percepción de suficiencia en el manejo de la crisis derivada de la pandemia del COVID-19\n Gobiernos nacionales o federales</b>
***
<br>
Resultados de distintas encuestadoras a nivel mundial.
Sólo se muestran las proporciones de evaluaciones positivas.
<br>
```{r fig.width=9, fig.height=6, fig.align='center', echo=F, background="white", message = FALSE, warning = FALSE, fig.cap="Percepción de suficiencia durante crisis de COVID-19"}

suficiente_fed <- cuadros_OP %>% 
  filter(Categoría=="Suficiente") %>% 
  filter(str_detect(id,"1")) %>% filter(!str_detect(Pregunta, "estado")) %>% 
  arrange(Encuesta) %>% 
  mutate(
    order = case_when(
      str_starts(País, "B")~ 1,
      str_starts(País, "J")~ 2,
      str_starts(País, "M")~ 3,
      str_starts(País, "E")~ 4,
      T ~ NA_real_
    ),
    prop = round(value*100),
    Porcentaje = paste0(round(value*100), "%")
  )

p <- 
  ggplot(suficiente_fed,
       aes(x = reorder(paste0(str_wrap(Encuesta, 20), "\n",País), order), y = prop,
           fill = País, label = Porcentaje)) +
  geom_col(width = 0.5) +
  theme_minimal() + 
  scale_fill_manual("",
                    values = c(
                      brewer.pal(n=9, "Blues")[2],
                      brewer.pal(n=9, "Blues")[4],
                      brewer.pal(n=9, "Blues")[7],
                      brewer.pal(n=9, "Blues")[9]
                    )) +
  labs(x="",
       y="%") +
  theme(strip.text = element_text(size = 20),
        panel.spacing.x = unit(3, "lines"),
        text = element_text(family = "Arial Narrow"),
        axis.text.x = element_text(size = 15),
        axis.text.y = element_text(size = 15),
        legend.position = "none")
  
plotly <- ggplotly(p, tooltip = c("fill", "label")) %>%
  plotly::layout(hovermode = "x", 
                 tickvalues ="", 
                 annotations = list(x = 1, y = 0, 
                                    text = caption, 
                                    showarrow = F, 
                                    xref='paper', 
                                    yref='paper', 
                                    xanchor='right', 
                                    yanchor='auto', 
                                    xshift=0, 
                                    yshift=0,
                                    font=list(size=15, color="red")))
htmlwidgets::saveWidget(plotly,selfcontained = F, file="suf_gob_op.html")
plotly
```
<br>

### <b>Percepción de suficiencia en el manejo de la crisis derivada de la pandemia del COVID-19\n Gobiernos locales</b>
***
<br>
Resultados de distintas encuestadoras a nivel mundial.
Sólo se muestran las proporciones de evaluaciones positivas.
<br>
```{r fig.width=9, fig.height=6, fig.align='center', echo=F, background="white", message = FALSE, warning = FALSE, fig.cap="Percepción suficiencia (Local) durante crisis de  COVID-19"}

suficiente_loc <- cuadros_OP %>% 
  filter(Categoría=="Suficiente") %>% 
  filter(str_detect(id,"1")) %>% filter(str_detect(Pregunta, "estado")) %>% 
  arrange(Encuesta) %>% 
  mutate(
    order = case_when(
      str_starts(País, "B")~ 1,
      str_starts(País, "J")~ 2,
      str_starts(País, "M")~ 3,
      str_starts(País, "U")~ 4,
      T ~ NA_real_
    ),
    prop = round(value*100),
    Porcentaje = paste0(round(value*100), "%")
  )

p <- 
  ggplot(suficiente_loc,
       aes(x = reorder(paste0(str_wrap(Encuesta, 20), "\n",País), order), y = prop,
           fill = País, label = Porcentaje)) +
  geom_col(width = 0.5) +
  theme_minimal() + 
  scale_fill_manual("",
                    values = c(
                      brewer.pal(n=9, "Blues")[4],
                      brewer.pal(n=9, "Blues")[9]
                    )) +
  labs(x="",
       y="%") +
  theme(strip.text = element_text(size = 20),
        panel.spacing.x = unit(3, "lines"),
        text = element_text(family = "Arial Narrow"),
        axis.text.x = element_text(size = 15),
        axis.text.y = element_text(size = 15),
        legend.position = "none")
  
plotly <- ggplotly(p, tooltip = c("fill", "label")) %>%
  plotly::layout(
                 hovermode = "x", 
                 tickvalues ="", 
                 annotations = list(x = 1, y = 0, 
                                    text = caption, 
                                    showarrow = F, 
                                    xref='paper', 
                                    yref='paper', 
                                    xanchor='right', 
                                    yanchor='auto', 
                                    xshift=0, 
                                    yshift=0,
                                    font=list(size=15, color="red")))
htmlwidgets::saveWidget(plotly,selfcontained = F, file="suf_gob_loc_op.html")
plotly
```
<br>

### <b>Percepción respecto al impacto del COVID-19 en la vida personal y familiar</b>
***
<br>
Resultados de distintas encuestadoras a nivel mundial
<br>
```{r fig.width=9, fig.height=6, fig.align='center', echo=F, background="white", message = FALSE, warning = FALSE, fig.cap="Percepción de impacto en vida personal y familiar durante crisis de COVID-19"}

impacto <- cuadros_OP %>% 
  filter(Categoría=="Cambios" | Categoría == "Impacto") %>% 
  filter(!str_detect(id,"9")) %>%
  arrange(Encuesta) %>% 
  mutate(
    facet = factor(Encuesta, levels = c("El Financiero", "Parametría", "Mitofsky",
                                        "NBC News Wall Street Journal Survey", "Kaiser Family Foundation")),
    prop = round(value*100),
    Porcentaje = paste0(round(value*100), "%")
  )

p <- 
  ggplot(impacto,
       aes(x = id, y = prop,
           fill = País, label = Porcentaje)) +
  geom_col(width = 0.5) +
  facet_wrap(~ facet, nrow = 2) +
  theme_minimal() + 
  scale_fill_manual("",
                    values = c(
                      brewer.pal(n=9, "Blues")[4],
                      brewer.pal(n=9, "Blues")[9]
                    )) +
  labs(x="",
       y="%") +
  theme(strip.text = element_text(size = 20),
        text = element_text(family = "Arial Narrow"),
        axis.text.x = element_text(size = 15),
        axis.text.y = element_text(size = 15),
        legend.position='none')
  
plotly <- ggplotly(p, tooltip = c("fill", "label")) %>%
  plotly::layout(hovermode = "x", 
                 tickvalues ="", 
                 annotations = list(x = 1, y = 0, 
                                    text = caption, 
                                    showarrow = F, 
                                    xref='paper', 
                                    yref='paper', 
                                    xanchor='right', 
                                    yanchor='auto', 
                                    xshift=0, 
                                    yshift=0,
                                    font=list(size=15, color="red")))
htmlwidgets::saveWidget(plotly,selfcontained = F, file="percepcion_fam_pers_op.html")
plotly
```
<br>

### <b>Percepción respecto al desarrollo de la pandemia del COVID-19</b>
***
<br>
Resultados de distintas encuestadoras a nivel mundial
<br>
```{r fig.width=9, fig.height=6, fig.align='center', echo=F, background="white", message = FALSE, warning = FALSE, fig.cap="Percepción respecto al desarrollo de la pandemia de COVID-19"}

empeorar <- cuadros_OP %>% 
  filter(Categoría=="Empeorar") %>% 
  filter(!str_detect(id,"9")) %>%
  arrange(Encuesta) %>% 
  mutate(
    prop = round(value*100),
    Porcentaje = paste0(round(value*100), "%")
  )

p <- 
  ggplot(empeorar,
       aes(x = str_wrap(id, 15), y = prop,
           fill = id, label = Porcentaje)) +
  geom_col(width = 0.5) +
  facet_wrap(País ~ Encuesta, nrow = 2) +
  theme_minimal() + 
  scale_fill_manual("",
                    values = c(
                      brewer.pal(n=9, "Blues")[4],
                      brewer.pal(n=9, "Blues")[7],
                      brewer.pal(n=9, "Blues")[9]
                    )) +
  labs(x="",
       y="%") +
  theme(strip.text = element_text(size = 20),
        text = element_text(family = "Arial Narrow"),
        axis.text.x = element_text(size = 15),
        axis.text.y = element_text(size = 15), 
        legend.position='none')
  
plotly <- ggplotly(p, tooltip = c("label")) %>%
  plotly::layout(hovermode = "x", 
                 tickvalues ="", 
                 annotations = list(x = 1, y = 0, 
                                    text = caption, 
                                    showarrow = F, 
                                    xref='paper', 
                                    yref='paper', 
                                    xanchor='right', 
                                    yanchor='auto', 
                                    xshift=0, 
                                    yshift=0,
                                    font=list(size=15, color="red")))
htmlwidgets::saveWidget(plotly,selfcontained = F, file="percepcion_epi_op.html")
plotly
```
Elaboración de Parametría con información publicada en WAPOR.
<br>

***
La pandemia del COVID 19 ya se perfila como la protagonista principal de la última década. Si bien han surgido nuevas enfermedades en los últimos años, los efectos específicos de este virus han puesto en evidencia la vulnerabilidad de los países frente a este tipo de fenómeno. 
<p>Por un lado, los débiles sistemas de salud hacen imposible atender efectivamente a todos los potenciales enfermos de la pandemia. Y, por otro lado, y especialmente en los países en desarrollo, la estructura económica construida hace insostenible una ausencia prolongada de la población económicamente activa. 
<p>En el tema, y desde abril del 2015, el científico informático Bill Gates ya advertía que “si algo ha de matar a más de 10 millones de personas en las próximas décadas, probablemente será un virus muy infeccioso más que una guerra”. Sin duda el camino que aún queda por combatir ante esta pandemia es largo, empero, la sociedad civil- hoy más que nunca- es el principal protagonista para dar fin a los efectos de esta crisis.



# Cotización
***
<p>
Favor de Contactar a [Diana Penagos](<mailto:dpenagos@parametria.com.mx?subject=Reporte Covid>) o directamente en [Parametría](http://www.parametria.com.mx/cotiza_parametria.php) para cotizar un `Seguimiento en Vivo` de algún tema de interés.
<br>

# Info
***
<br>
Descargue el archivo RMarkdown para crear este reporte aquí
[Rmarkdown](https://github.com/LorenzoLeon/covid19_mex_Reportes/REPORTE_COVID.Rmd)
<br>
También puedes descargar el tema de este Rmd [aquí](https://holtzy.github.io/Pimp-my-rmd/).
